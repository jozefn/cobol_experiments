       IDENTIFICATION DIVISION.
       PROGRAM-ID. WR-INDEX.

       ENVIRONMENT DIVISION.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT INDEX-FILE ASSIGN TO 'ABINDEX'
                   STATUS IS WS-INDEX-STATUS
                   ORGANIZATION IS SEQUENTIAL.

       DATA DIVISION.

       FILE SECTION.
       FD INDEX-FILE.
       01 INDEX-RECORD.
          05 INDEX-FIELD PIC 9(09).


       WORKING-STORAGE SECTION.
       01 WS-INDEX-STATUS PIC X(02).
       01 WS-INDEX-NUMBER EXTERNAL PIC S9(09).
       01 WS-INDEX-RECORD.
          05 WS-INDEX-FIELD PIC 9(09).

       PROCEDURE DIVISION.
           OPEN INPUT INDEX-FILE.
           IF WS-INDEX-STATUS NOT EQUAL '00'
              OPEN OUTPUT INDEX-FILE
              MOVE 0 TO WS-INDEX-FIELD
              WRITE INDEX-RECORD FROM WS-INDEX-RECORD
              CLOSE INDEX-FILE.
           IF WS-INDEX-NUMBER LESS THAN 0
              OPEN OUTPUT INDEX-FILE
              MOVE 0 TO WS-INDEX-FIELD
              WRITE INDEX-RECORD FROM WS-INDEX-RECORD
              CLOSE INDEX-FILE.

           OPEN INPUT INDEX-FILE.
           READ INDEX-FILE INTO WS-INDEX-RECORD.
           CLOSE INDEX-FILE.
           ADD 1 TO WS-INDEX-FIELD
           OPEN OUTPUT INDEX-FILE.
           WRITE INDEX-RECORD FROM WS-INDEX-RECORD.
           CLOSE INDEX-FILE.
           MOVE WS-INDEX-FIELD TO WS-INDEX-NUMBER.
       GOBACK.
